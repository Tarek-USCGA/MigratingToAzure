USE [INSERT_YOUR_DB_NAME_HERE]
GO
/****** Object:  StoredProcedure [ACADEMICS].[InstrMidTerm_BadGrades]    Script Date: 2/1/2023 2:15:57 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

Create PROCEDURE [ACADEMICS].[InstrMidTerm_BadGrades]
	@varAcadPrd_ID int,
	@varInsAcadID int
AS
   
   BEGIN
      DECLARE
         @msBad_Code int, 
         @msBad_Message varchar(250)
      BEGIN TRY
         select sec.TITLE, sec.SECTION_ID, ent.Id as 'CadetAcadID', ent.NmFirst, ent.NmLast, mvg.GRADE, df.Id from ACADEMICS.COURSE_OFFERINGS co
	INNER JOIN ACADEMICS.SECTION AS sec ON co.COURSE_OFFERINGS_ID = sec.COURSE_OFFERINGS_ID
	INNER JOIN ACADEMICS.PERSON_SECTION_ASSIGNMENT AS psa ON psa.SECTION_ID = sec.SECTION_ID
	INNER JOIN COMMON.Entity AS ent ON psa.ACAD_ID = ent.ID
	inner join ACADEMICS.INSTRUCTOR_SECTION ins on ins.SECTION_ID = sec.SECTION_ID and ins.ACAD_ID = @varInsAcadID
	inner JOIN ACADEMICS.VALID_GRADES AS mvg ON psa.MIDTERM_GRD_ID = mvg.VALID_GRADES_ID 
	left outer join ACADEMICS.DF_FORM as df on df.AcademyPeriodId = co.TIME_PERIOD_ID and df.Section_ID = sec.SECTION_ID
		and psa.ACAD_ID = df.Cadet_AcadID and df.FormType = 'MidSemester'
 	where co.TIME_PERIOD_ID = @varAcadPrd_ID and psa.MIDTERM_GRD_ID in (7,8) 
 	order by ent.NmLast, ent.NmFirst;
	RETURN 

      END TRY

end

USE [INSERT_YOUR_DB_NAME_HERE]
GO

/****** Object:  StoredProcedure [ACADEMICS].[InstrFinal_BadGrades]    Script Date: 2/1/2023 2:18:06 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [ACADEMICS].[InstrFinal_BadGrades]
	@varAcadPrd_ID int,
	@varInsAcadID int
AS
   /*Generated by SQL Server Migration Assistant for Oracle version 5.2.1259.*/
   BEGIN
      DECLARE
         @msBad_Code int, 
         @msBad_Message varchar(250)
      BEGIN TRY
         select sec.TITLE, sec.SECTION_ID, ent.Id as 'CadetAcadID', ent.NmFirst, ent.NmLast, 
	fvg.GRADE, df.Id from ACADEMICS.COURSE_OFFERINGS co
	INNER JOIN ACADEMICS.SECTION AS sec ON co.COURSE_OFFERINGS_ID = sec.COURSE_OFFERINGS_ID
	INNER JOIN ACADEMICS.PERSON_SECTION_ASSIGNMENT AS psa ON psa.SECTION_ID = sec.SECTION_ID
	INNER JOIN COMMON.Entity AS ent ON psa.ACAD_ID = ent.ID
	inner join ACADEMICS.INSTRUCTOR_SECTION ins on ins.SECTION_ID = sec.SECTION_ID and ins.ACAD_ID = @varInsAcadID
	LEFT OUTER JOIN ACADEMICS.VALID_GRADES AS fvg ON psa.FINAL_GRD_ID = fvg.VALID_GRADES_ID 
	left outer join ACADEMICS.DF_FORM as df on df.AcademyPeriodId = co.TIME_PERIOD_ID and df.Section_ID = sec.SECTION_ID
		and psa.ACAD_ID = df.Cadet_AcadID and df.FormType = 'Final'
 	where co.TIME_PERIOD_ID = @varAcadPrd_ID and psa.FINAL_GRD_ID in (7,8,9,14,15) 
 	order by ent.NmLast, ent.NmFirst;
	RETURN 

      END TRY
   END
GO
